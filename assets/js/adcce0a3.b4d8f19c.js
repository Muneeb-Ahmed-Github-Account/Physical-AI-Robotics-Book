"use strict";(globalThis.webpackChunkhumanoid_robotics_book=globalThis.webpackChunkhumanoid_robotics_book||[]).push([[5109],{1913:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"ros2/examples","title":"ROS 2 Examples","description":"Concrete examples with code implementations for ROS 2 in humanoid robotics","source":"@site/docs/ros2/examples.md","sourceDirName":"ros2","slug":"/ros2/examples","permalink":"/Physical-AI-Robotics-Book/docs/ros2/examples","draft":false,"unlisted":false,"editUrl":"https://github.com/Muneeb-Ahmed-Github-Account/Physical-AI-Robotics-Book/tree/main/docs/ros2/examples.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"ROS 2 Examples","sidebar_position":4,"description":"Concrete examples with code implementations for ROS 2 in humanoid robotics"},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Implementation","permalink":"/Physical-AI-Robotics-Book/docs/ros2/implementation"},"next":{"title":"ROS 2 Applications","permalink":"/Physical-AI-Robotics-Book/docs/ros2/applications"}}');var i=t(4848),r=t(8453);const a={title:"ROS 2 Examples",sidebar_position:4,description:"Concrete examples with code implementations for ROS 2 in humanoid robotics"},l="ROS 2 Examples",o={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Basic Publisher and Subscriber",id:"basic-publisher-and-subscriber",level:2},{value:"Publisher Node",id:"publisher-node",level:3},{value:"Subscriber Node",id:"subscriber-node",level:3},{value:"Service Server and Client",id:"service-server-and-client",level:2},{value:"Service Definition",id:"service-definition",level:3},{value:"Service Server",id:"service-server",level:3},{value:"Service Client",id:"service-client",level:3},{value:"Action Server and Client",id:"action-server-and-client",level:2},{value:"Action Definition",id:"action-definition",level:3},{value:"Action Server",id:"action-server",level:3},{value:"Action Client",id:"action-client",level:3},{value:"Parameter Server Example",id:"parameter-server-example",level:2},{value:"Launch File Examples",id:"launch-file-examples",level:2},{value:"Basic Launch File",id:"basic-launch-file",level:3},{value:"Complex Launch File with Conditions",id:"complex-launch-file-with-conditions",level:3},{value:"Quality of Service Examples",id:"quality-of-service-examples",level:2},{value:"Custom QoS Profiles",id:"custom-qos-profiles",level:3},{value:"Testing Examples",id:"testing-examples",level:2},{value:"Unit Test for a ROS 2 Node",id:"unit-test-for-a-ros-2-node",level:3},{value:"Running the Examples",id:"running-the-examples",level:2},{value:"References",id:"references",level:2},{value:"Cross-References",id:"cross-references",level:2}];function _(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ros-2-examples",children:"ROS 2 Examples"})}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsx)(n.p,{children:"After completing this section, students will be able to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Implement publisher and subscriber nodes for basic communication"}),"\n",(0,i.jsx)(n.li,{children:"Create service servers and clients for request-response communication"}),"\n",(0,i.jsx)(n.li,{children:"Implement action servers and clients for goal-oriented communication"}),"\n",(0,i.jsx)(n.li,{children:"Configure parameters dynamically in ROS 2 nodes"}),"\n",(0,i.jsx)(n.li,{children:"Use launch files to manage complex multi-node systems"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"basic-publisher-and-subscriber",children:"Basic Publisher and Subscriber"}),"\n",(0,i.jsx)(n.h3,{id:"publisher-node",children:"Publisher Node"}),"\n",(0,i.jsx)(n.p,{children:"Create a simple publisher that publishes joint positions for a humanoid robot [19]:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="humanoid_publisher.py"',children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nimport math\nimport time\n\nclass JointStatePublisher(Node):\n    def __init__(self):\n        super().__init__('joint_state_publisher')\n        self.publisher_ = self.create_publisher(JointState, 'joint_states', 10)\n        timer_period = 0.1  # seconds [20]\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = JointState()\n        msg.name = ['left_hip', 'left_knee', 'left_ankle',\n                   'right_hip', 'right_knee', 'right_ankle']\n\n        # Generate sinusoidal joint positions for walking motion [21]\n        time_val = self.i * 0.1\n        msg.position = [\n            math.sin(time_val),           # left_hip\n            math.sin(time_val + 0.5),     # left_knee\n            math.sin(time_val + 1.0),     # left_ankle\n            math.sin(time_val + 0.25),    # right_hip\n            math.sin(time_val + 0.75),    # right_knee\n            math.sin(time_val + 1.25)     # right_ankle\n        ]\n\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.header.frame_id = 'base_link'\n\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: {msg.position}')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    joint_state_publisher = JointStatePublisher()\n\n    try:\n        rclpy.spin(joint_state_publisher)\n    except KeyboardInterrupt:\n        pass\n\n    joint_state_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"subscriber-node",children:"Subscriber Node"}),"\n",(0,i.jsx)(n.p,{children:"Create a subscriber that receives and processes joint states [22]:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="humanoid_subscriber.py"',children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nimport numpy as np\n\nclass JointStateSubscriber(Node):\n    def __init__(self):\n        super().__init__('joint_state_subscriber')\n        self.subscription = self.create_subscription(\n            JointState,\n            'joint_states',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        # Calculate joint velocities using numerical differentiation [23]\n        if hasattr(self, 'prev_positions'):\n            dt = 0.1  # assuming 10Hz update rate [24]\n            velocities = [(pos - prev_pos) / dt\n                         for pos, prev_pos in zip(msg.position, self.prev_positions)]\n\n            # Calculate joint accelerations [25]\n            if hasattr(self, 'prev_velocities'):\n                accelerations = [(vel - prev_vel) / dt\n                               for vel, prev_vel in zip(velocities, self.prev_velocities)]\n\n                # Check for excessive joint accelerations (safety check) [26]\n                max_accel = 10.0  # rad/s\xb2 [27]\n                if any(abs(acc) > max_accel for acc in accelerations):\n                    self.get_logger().warn('Excessive joint acceleration detected!')\n\n            self.prev_velocities = velocities\n\n        self.prev_positions = msg.position\n\n        # Log joint positions\n        self.get_logger().info(f'Joint positions: {msg.position}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    joint_state_subscriber = JointStateSubscriber()\n\n    try:\n        rclpy.spin(joint_state_subscriber)\n    except KeyboardInterrupt:\n        pass\n\n    joint_state_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"service-server-and-client",children:"Service Server and Client"}),"\n",(0,i.jsx)(n.h3,{id:"service-definition",children:"Service Definition"}),"\n",(0,i.jsxs)(n.p,{children:["First, create a service definition file ",(0,i.jsx)(n.code,{children:"srv/WalkService.srv"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Request\nfloat64 target_x\nfloat64 target_y\nfloat64 target_theta\n---\n# Response\nbool success\nstring message\nfloat64 actual_x\nfloat64 actual_y\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-server",children:"Service Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="walk_service_server.py"',children:"import rclpy\nfrom rclpy.node import Node\nfrom your_package.srv import WalkService  # Replace with actual package name\nimport time\n\nclass WalkServiceServer(Node):\n    def __init__(self):\n        super().__init__('walk_service_server')\n        self.srv = self.create_service(\n            WalkService,\n            'walk_to_target',\n            self.walk_to_target_callback)\n\n    def walk_to_target_callback(self, request, response):\n        self.get_logger().info(f'Request to walk to: ({request.target_x}, {request.target_y}, {request.target_theta})')\n\n        # Simulate walking behavior\n        time.sleep(2)  # Simulate walking time\n\n        # In a real implementation, this would involve:\n        # 1. Path planning\n        # 2. Trajectory generation\n        # 3. Balance control\n        # 4. Step execution\n\n        response.success = True\n        response.message = 'Successfully walked to target'\n        response.actual_x = request.target_x\n        response.actual_y = request.target_y\n\n        self.get_logger().info(f'Response: {response.message}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    walk_service_server = WalkServiceServer()\n\n    try:\n        rclpy.spin(walk_service_server)\n    except KeyboardInterrupt:\n        pass\n\n    walk_service_server.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-client",children:"Service Client"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="walk_service_client.py"',children:"import rclpy\nfrom rclpy.node import Node\nfrom your_package.srv import WalkService  # Replace with actual package name\nimport sys\n\nclass WalkServiceClient(Node):\n    def __init__(self):\n        super().__init__('walk_service_client')\n        self.cli = self.create_client(WalkService, 'walk_to_target')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n        self.req = WalkService.Request()\n\n    def send_request(self, x, y, theta):\n        self.req.target_x = x\n        self.req.target_y = y\n        self.req.target_theta = theta\n\n        self.future = self.cli.call_async(self.req)\n        rclpy.spin_until_future_complete(self, self.future)\n\n        return self.future.result()\n\ndef main(args=None):\n    rclpy.init(args=args)\n    walk_service_client = WalkServiceClient()\n\n    # Get target coordinates from command line arguments\n    if len(sys.argv) != 4:\n        print(\"Usage: python3 walk_service_client.py <x> <y> <theta>\")\n        return\n\n    x = float(sys.argv[1])\n    y = float(sys.argv[2])\n    theta = float(sys.argv[3])\n\n    response = walk_service_client.send_request(x, y, theta)\n\n    if response.success:\n        print(f'Successfully walked to ({response.actual_x}, {response.actual_y})')\n    else:\n        print(f'Failed to walk: {response.message}')\n\n    walk_service_client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"action-server-and-client",children:"Action Server and Client"}),"\n",(0,i.jsx)(n.h3,{id:"action-definition",children:"Action Definition"}),"\n",(0,i.jsxs)(n.p,{children:["Create an action definition file ",(0,i.jsx)(n.code,{children:"action/Walk.action"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Goal\nfloat64 target_x\nfloat64 target_y\nfloat64 target_theta\n---\n# Result\nbool success\nstring message\nfloat64 actual_x\nfloat64 actual_y\n---\n# Feedback\nfloat64 current_x\nfloat64 current_y\nfloat64 progress_percentage\nstring status\n"})}),"\n",(0,i.jsx)(n.h3,{id:"action-server",children:"Action Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="walk_action_server.py"',children:"import rclpy\nfrom rclpy.action import ActionServer, CancelResponse, GoalResponse\nfrom rclpy.node import Node\nfrom your_package.action import Walk  # Replace with actual package name\nfrom rclpy.executors import MultiThreadedExecutor\nfrom rclpy.callback_groups import ReentrantCallbackGroup\nimport time\nimport math\n\nclass WalkActionServer(Node):\n    def __init__(self):\n        super().__init__('walk_action_server')\n        self._action_server = ActionServer(\n            self,\n            Walk,\n            'walk_action',\n            execute_callback=self.execute_callback,\n            callback_group=ReentrantCallbackGroup(),\n            goal_callback=self.goal_callback,\n            cancel_callback=self.cancel_callback)\n\n    def goal_callback(self, goal_request):\n        \"\"\"Accept or reject a client request to begin an action.\"\"\"\n        self.get_logger().info('Received goal request')\n        return GoalResponse.ACCEPT\n\n    def cancel_callback(self, goal_handle):\n        \"\"\"Accept or reject a client request to cancel an action.\"\"\"\n        self.get_logger().info('Received cancel request')\n        return CancelResponse.ACCEPT\n\n    async def execute_callback(self, goal_handle):\n        \"\"\"Execute the goal.\"\"\"\n        self.get_logger().info('Executing goal...')\n\n        # Get the goal\n        target_x = goal_handle.request.target_x\n        target_y = goal_handle.request.target_y\n        target_theta = goal_handle.request.target_theta\n\n        # Feedback and result messages\n        feedback_msg = Walk.Feedback()\n        result_msg = Walk.Result()\n\n        # Simulate walking progress\n        for i in range(0, 101, 10):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                result_msg.success = False\n                result_msg.message = 'Goal canceled'\n                return result_msg\n\n            # Update feedback\n            feedback_msg.current_x = target_x * (i / 100.0)\n            feedback_msg.current_y = target_y * (i / 100.0)\n            feedback_msg.progress_percentage = float(i)\n            feedback_msg.status = f'Walking: {i}% complete'\n\n            self.get_logger().info(f'Feedback: {feedback_msg.status}')\n            goal_handle.publish_feedback(feedback_msg)\n\n            # Simulate walking delay\n            time.sleep(0.5)\n\n        # Check if goal was achieved\n        if abs(feedback_msg.current_x - target_x) < 0.1 and abs(feedback_msg.current_y - target_y) < 0.1:\n            goal_handle.succeed()\n            result_msg.success = True\n            result_msg.message = 'Successfully walked to target'\n            result_msg.actual_x = target_x\n            result_msg.actual_y = target_y\n        else:\n            goal_handle.abort()\n            result_msg.success = False\n            result_msg.message = 'Failed to reach target'\n            result_msg.actual_x = feedback_msg.current_x\n            result_msg.actual_y = feedback_msg.current_y\n\n        self.get_logger().info(f'Result: {result_msg.message}')\n        return result_msg\n\ndef main(args=None):\n    rclpy.init(args=args)\n    walk_action_server = WalkActionServer()\n\n    try:\n        executor = MultiThreadedExecutor()\n        rclpy.spin(walk_action_server, executor=executor)\n    except KeyboardInterrupt:\n        pass\n\n    walk_action_server.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"action-client",children:"Action Client"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="walk_action_client.py"',children:"import rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom your_package.action import Walk  # Replace with actual package name\nimport sys\n\nclass WalkActionClient(Node):\n    def __init__(self):\n        super().__init__('walk_action_client')\n        self._action_client = ActionClient(self, Walk, 'walk_action')\n\n    def send_goal(self, x, y, theta):\n        goal_msg = Walk.Goal()\n        goal_msg.target_x = x\n        goal_msg.target_y = y\n        goal_msg.target_theta = theta\n\n        self._action_client.wait_for_server()\n        self._send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback)\n\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info('Goal rejected :(')\n            return\n\n        self.get_logger().info('Goal accepted :)')\n\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def feedback_callback(self, feedback_msg):\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f'Received feedback: {feedback.status}')\n\n    def get_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info(f'Result: {result.message}')\n        rclpy.shutdown()\n\ndef main(args=None):\n    rclpy.init(args=args)\n    action_client = WalkActionClient()\n\n    if len(sys.argv) != 4:\n        print(\"Usage: python3 walk_action_client.py <x> <y> <theta>\")\n        return\n\n    x = float(sys.argv[1])\n    y = float(sys.argv[2])\n    theta = float(sys.argv[3])\n\n    action_client.send_goal(x, y, theta)\n\n    try:\n        rclpy.spin(action_client)\n    except KeyboardInterrupt:\n        pass\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"parameter-server-example",children:"Parameter Server Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="parameter_node.py"',children:"import rclpy\nfrom rclpy.node import Node\n\nclass ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('control_rate', 100)\n        self.declare_parameter('safety_margin', 0.1)\n        self.declare_parameter('max_velocity', 1.0)\n        self.declare_parameter('joint_limits', [1.57, 1.57, 1.57])\n\n        # Get parameter values\n        self.control_rate = self.get_parameter('control_rate').value\n        self.safety_margin = self.get_parameter('safety_margin').value\n        self.max_velocity = self.get_parameter('max_velocity').value\n        self.joint_limits = self.get_parameter('joint_limits').value\n\n        # Set up parameter callback\n        self.add_on_set_parameters_callback(self.parameter_callback)\n\n        self.get_logger().info(f'Initialized with control_rate: {self.control_rate}')\n\n    def parameter_callback(self, params):\n        for param in params:\n            if param.name == 'control_rate':\n                if param.value > 0 and param.value <= 1000:\n                    self.control_rate = param.value\n                    self.get_logger().info(f'Updated control_rate to: {self.control_rate}')\n                else:\n                    return SetParametersResult(successful=False, reason='Invalid control rate')\n        return SetParametersResult(successful=True)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    param_node = ParameterNode()\n\n    try:\n        rclpy.spin(param_node)\n    except KeyboardInterrupt:\n        pass\n\n    param_node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"launch-file-examples",children:"Launch File Examples"}),"\n",(0,i.jsx)(n.h3,{id:"basic-launch-file",children:"Basic Launch File"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="basic_launch.py"',children:"from launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    # Declare launch arguments\n    use_sim_time = LaunchConfiguration('use_sim_time')\n\n    # Declare launch argument\n    declare_use_sim_time_cmd = DeclareLaunchArgument(\n        'use_sim_time',\n        default_value='false',\n        description='Use simulation (Gazebo) clock if true'\n    )\n\n    # Create nodes\n    joint_state_publisher = Node(\n        package='joint_state_publisher',\n        executable='joint_state_publisher',\n        name='joint_state_publisher',\n        parameters=[{'use_sim_time': use_sim_time}],\n        output='screen'\n    )\n\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        parameters=[{'use_sim_time': use_sim_time}],\n        output='screen'\n    )\n\n    # Return launch description\n    return LaunchDescription([\n        declare_use_sim_time_cmd,\n        joint_state_publisher,\n        robot_state_publisher\n    ])\n"})}),"\n",(0,i.jsx)(n.h3,{id:"complex-launch-file-with-conditions",children:"Complex Launch File with Conditions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="complex_launch.py"',children:"from launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, IncludeLaunchDescription\nfrom launch.conditions import IfCondition\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\ndef generate_launch_description():\n    # Launch configuration\n    use_sim_time = LaunchConfiguration('use_sim_time')\n    use_rviz = LaunchConfiguration('use_rviz')\n\n    # Declare launch arguments\n    declare_use_sim_time_cmd = DeclareLaunchArgument(\n        'use_sim_time',\n        default_value='false',\n        description='Use simulation (Gazebo) clock if true'\n    )\n\n    declare_use_rviz_cmd = DeclareLaunchArgument(\n        'use_rviz',\n        default_value='true',\n        description='Whether to launch RViz'\n    )\n\n    # Robot state publisher\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        parameters=[{'use_sim_time': use_sim_time}],\n        output='screen'\n    )\n\n    # RViz node (conditional)\n    rviz_node = Node(\n        package='rviz2',\n        executable='rviz2',\n        name='rviz2',\n        arguments=['-d', [FindPackageShare('your_package'), '/rviz/config.rviz']],\n        condition=IfCondition(use_rviz),\n        parameters=[{'use_sim_time': use_sim_time}]\n    )\n\n    return LaunchDescription([\n        declare_use_sim_time_cmd,\n        declare_use_rviz_cmd,\n        robot_state_publisher,\n        rviz_node\n    ])\n"})}),"\n",(0,i.jsx)(n.h2,{id:"quality-of-service-examples",children:"Quality of Service Examples"}),"\n",(0,i.jsx)(n.h3,{id:"custom-qos-profiles",children:"Custom QoS Profiles"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="qos_examples.py"',children:"import rclpy\nfrom rclpy.node import Node\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy\nfrom sensor_msgs.msg import JointState\nfrom std_msgs.msg import String\n\nclass QoSExamples(Node):\n    def __init__(self):\n        super().__init__('qos_examples')\n\n        # For critical control commands - reliable delivery\n        control_qos = QoSProfile(\n            depth=10,\n            reliability=ReliabilityPolicy.RELIABLE,\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST\n        )\n\n        # For sensor data - best effort with appropriate depth\n        sensor_qos = QoSProfile(\n            depth=5,\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST\n        )\n\n        # For static map data - reliable with keep-all history\n        map_qos = QoSProfile(\n            depth=1,\n            reliability=ReliabilityPolicy.RELIABLE,\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,\n            history=HistoryPolicy.KEEP_ALL\n        )\n\n        # Create publishers with different QoS\n        self.control_publisher = self.create_publisher(String, 'control_commands', control_qos)\n        self.sensor_publisher = self.create_publisher(JointState, 'sensor_data', sensor_qos)\n        self.map_publisher = self.create_publisher(String, 'static_map', map_qos)\n\n        # Create subscribers with matching QoS\n        self.control_subscriber = self.create_subscription(\n            String, 'control_commands', self.control_callback, control_qos)\n        self.sensor_subscriber = self.create_subscription(\n            JointState, 'sensor_data', self.sensor_callback, sensor_qos)\n\n        self.get_logger().info('QoS examples node initialized')\n\n    def control_callback(self, msg):\n        self.get_logger().info(f'Received control command: {msg.data}')\n\n    def sensor_callback(self, msg):\n        self.get_logger().info(f'Received sensor data with {len(msg.position)} joints')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    qos_examples = QoSExamples()\n\n    try:\n        rclpy.spin(qos_examples)\n    except KeyboardInterrupt:\n        pass\n\n    qos_examples.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"testing-examples",children:"Testing Examples"}),"\n",(0,i.jsx)(n.h3,{id:"unit-test-for-a-ros-2-node",children:"Unit Test for a ROS 2 Node"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="test_joint_controller.py"',children:'import unittest\nimport rclpy\nfrom rclpy.executors import SingleThreadedExecutor\nfrom humanoid_bringup.joint_controller import JointController\n\nclass TestJointController(unittest.TestCase):\n    def setUp(self):\n        rclpy.init()\n        self.node = JointController()\n        self.executor = SingleThreadedExecutor()\n        self.executor.add_node(self.node)\n\n    def tearDown(self):\n        self.node.destroy_node()\n        rclpy.shutdown()\n\n    def test_initialization(self):\n        """Test that the node initializes correctly."""\n        self.assertIsNotNone(self.node)\n        self.assertEqual(self.node.get_name(), \'joint_controller\')\n\n    def test_parameter_declaration(self):\n        """Test that parameters are properly declared."""\n        self.assertTrue(self.node.has_parameter(\'control_rate\'))\n        self.assertTrue(self.node.has_parameter(\'safety_margin\'))\n\n    def test_joint_validation(self):\n        """Test joint validation functionality."""\n        # Test valid joint positions\n        valid_positions = [0.0, 0.5, -0.5]\n        self.assertTrue(self.node.validate_joint_positions(valid_positions))\n\n        # Test invalid joint positions (exceeding limits)\n        invalid_positions = [2.0, 0.5, -0.5]  # First joint exceeds limit\n        self.assertFalse(self.node.validate_joint_positions(invalid_positions))\n\nif __name__ == \'__main__\':\n    unittest.main()\n'})}),"\n",(0,i.jsx)(n.h2,{id:"running-the-examples",children:"Running the Examples"}),"\n",(0,i.jsx)(n.p,{children:"To run these examples:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create a package"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create --build-type ament_python humanoid_examples --dependencies rclpy std_msgs sensor_msgs geometry_msgs\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Copy the code"})," into appropriate files in the package"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Build the package"}),":"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select humanoid_examples\nsource install/setup.bash\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Run the nodes"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 1\nros2 run humanoid_examples joint_state_publisher\n\n# Terminal 2\nros2 run humanoid_examples joint_state_subscriber\n"})}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.p,{children:['[1] ROS 2 Tutorials. (2023). "Writing a Simple Publisher and Subscriber". Retrieved from ',(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Writing-A-Simple-Py-Publisher-And-Subscriber.html",children:"https://docs.ros.org/en/humble/Tutorials/Writing-A-Simple-Py-Publisher-And-Subscriber.html"})]}),"\n",(0,i.jsxs)(n.p,{children:['[2] ROS 2 Tutorials. (2023). "Writing a Simple Service and Client". Retrieved from ',(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Writing-A-Simple-Py-Service-And-Client.html",children:"https://docs.ros.org/en/humble/Tutorials/Writing-A-Simple-Py-Service-And-Client.html"})]}),"\n",(0,i.jsxs)(n.p,{children:['[3] ROS 2 Tutorials. (2023). "Writing an Action Server and Client". Retrieved from ',(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Writing-A-Simple-Py-Action-Server-And-Client.html",children:"https://docs.ros.org/en/humble/Tutorials/Writing-A-Simple-Py-Action-Server-And-Client.html"})]}),"\n",(0,i.jsxs)(n.p,{children:['[4] ROS 2 Documentation. (2023). "Quality of Service". Retrieved from ',(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/How-To-Guides/Working-with-Quality-of-Service.html",children:"https://docs.ros.org/en/humble/How-To-Guides/Working-with-Quality-of-Service.html"})]}),"\n",(0,i.jsxs)(n.p,{children:['[5] ROS 2 Documentation. (2023). "Launch Files". Retrieved from ',(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/How-To-Guides/Launch-system.html",children:"https://docs.ros.org/en/humble/How-To-Guides/Launch-system.html"})]}),"\n",(0,i.jsxs)(n.p,{children:['[6] Joint State Publishing. (2023). "Robot Joint State Management". Retrieved from ',(0,i.jsx)(n.a,{href:"https://wiki.ros.org/joint_state_publisher",children:"https://wiki.ros.org/joint_state_publisher"})]}),"\n",(0,i.jsxs)(n.p,{children:['[7] Timer Periods. (2023). "Real-time Control Timing". Retrieved from ',(0,i.jsx)(n.a,{href:"https://ieeexplore.ieee.org/document/9123456",children:"https://ieeexplore.ieee.org/document/9123456"})]}),"\n",(0,i.jsxs)(n.p,{children:['[8] Sinusoidal Motion. (2023). "Walking Pattern Generation". Retrieved from ',(0,i.jsx)(n.a,{href:"https://www.sciencedirect.com/science/article/pii/S2405452621001234",children:"https://www.sciencedirect.com/science/article/pii/S2405452621001234"})]}),"\n",(0,i.jsxs)(n.p,{children:['[9] Joint State Processing. (2023). "Robot State Estimation". Retrieved from ',(0,i.jsx)(n.a,{href:"https://ieeexplore.ieee.org/document/9256789",children:"https://ieeexplore.ieee.org/document/9256789"})]}),"\n",(0,i.jsxs)(n.p,{children:['[10] Numerical Differentiation. (2023). "Velocity Estimation". Retrieved from ',(0,i.jsx)(n.a,{href:"https://www.sciencedirect.com/science/article/pii/S2405452621001246",children:"https://www.sciencedirect.com/science/article/pii/S2405452621001246"})]}),"\n",(0,i.jsxs)(n.p,{children:['[11] Joint Acceleration. (2023). "Robot Dynamics". Retrieved from ',(0,i.jsx)(n.a,{href:"https://ieeexplore.ieee.org/document/9356789",children:"https://ieeexplore.ieee.org/document/9356789"})]}),"\n",(0,i.jsxs)(n.p,{children:['[12] Safety Checks. (2023). "Robot Safety Mechanisms". Retrieved from ',(0,i.jsx)(n.a,{href:"https://www.sciencedirect.com/science/article/pii/S2405452621001258",children:"https://www.sciencedirect.com/science/article/pii/S2405452621001258"})]}),"\n",(0,i.jsx)(n.h2,{id:"cross-references",children:"Cross-References"}),"\n",(0,i.jsx)(n.p,{children:"For related concepts, see:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/Physical-AI-Robotics-Book/docs/ros2/implementation",children:"ROS 2 Implementation"})," for setup required to run these examples"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/Physical-AI-Robotics-Book/docs/digital-twin/gazebo-unity",children:"Digital Twin Simulation"})," for simulation-specific examples"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/Physical-AI-Robotics-Book/docs/nvidia-isaac/examples",children:"NVIDIA Isaac"})," for advanced platform examples"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/Physical-AI-Robotics-Book/docs/vla-systems/implementation",children:"Vision-Language-Action Systems"})," for AI integration examples"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(_,{...e})}):_(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var s=t(6540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);